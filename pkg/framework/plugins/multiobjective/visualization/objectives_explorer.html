<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Objective Function Explorer</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .control-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }
        .control-group h3 {
            margin-top: 0;
            color: #333;
        }
        .slider-container {
            margin: 10px 0;
        }
        .slider-container label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 14px;
        }
        .slider-value {
            display: inline-block;
            width: 60px;
            text-align: right;
            font-weight: normal;
            color: #666;
        }
        input[type="range"] {
            width: 100%;
            margin: 5px 0;
        }
        .plot-container {
            height: 400px;
            margin: 20px 0;
        }
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .result-box {
            text-align: center;
            padding: 20px;
            background: #e3f2fd;
            border-radius: 6px;
        }
        .result-box.disruption {
            background: #ffebee;
        }
        .result-box.cost {
            background: #e8f5e9;
        }
        .result-box.balance {
            background: #fff3e0;
        }
        .result-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        .result-label {
            font-size: 18px;
            color: #666;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Multi-Objective Function Explorer</h1>
    
    <div class="info">
        <strong>Instructions:</strong> Adjust the sliders to see how each objective function responds to different inputs. 
        All objectives are normalized to [0, 1] range where 0 is best and 1 is worst.
    </div>

    <div class="container">
        <h2>Input Parameters</h2>
        <div class="controls">
            <!-- Common Parameters -->
            <div class="control-group">
                <h3>Common Parameters</h3>
                <div class="slider-container">
                    <label>Total Pods: <span class="slider-value" id="totalPods-value">20</span></label>
                    <input type="range" id="totalPods" min="1" max="100" value="20" step="1">
                </div>
                <div class="slider-container">
                    <label>Pods Moved: <span class="slider-value" id="podsMoved-value">5</span></label>
                    <input type="range" id="podsMoved" min="0" max="100" value="5" step="1">
                </div>
            </div>

            <!-- Disruption Parameters -->
            <div class="control-group">
                <h3>Disruption Parameters</h3>
                <div class="slider-container">
                    <label>Average Cold Start (min): <span class="slider-value" id="avgColdStart-value">2.0</span></label>
                    <input type="range" id="avgColdStart" min="0" max="10" value="2" step="0.1">
                </div>
                <div class="slider-container">
                    <label>Max Time Slots Disrupted: <span class="slider-value" id="timeSlots-value">3</span></label>
                    <input type="range" id="timeSlots" min="0" max="10" value="3" step="1">
                </div>
                <div class="slider-container">
                    <label>Weight - Movement: <span class="slider-value" id="wMove-value">0.40</span></label>
                    <input type="range" id="wMove" min="0" max="1" value="0.4" step="0.01">
                </div>
                <div class="slider-container">
                    <label>Weight - Cold Start: <span class="slider-value" id="wCold-value">0.35</span></label>
                    <input type="range" id="wCold" min="0" max="1" value="0.35" step="0.01">
                </div>
                <div class="slider-container">
                    <label>Weight - Time Slots: <span class="slider-value" id="wTime-value">0.25</span></label>
                    <input type="range" id="wTime" min="0" max="1" value="0.25" step="0.01">
                </div>
            </div>

            <!-- Cost Parameters -->
            <div class="control-group">
                <h3>Cost Parameters</h3>
                <div class="slider-container">
                    <label>Current Cost ($/hr): <span class="slider-value" id="currentCost-value">5.0</span></label>
                    <input type="range" id="currentCost" min="0" max="20" value="5" step="0.1">
                </div>
                <div class="slider-container">
                    <label>Min Possible Cost ($/hr): <span class="slider-value" id="minCost-value">2.0</span></label>
                    <input type="range" id="minCost" min="0" max="20" value="2" step="0.1">
                </div>
                <div class="slider-container">
                    <label>Max Possible Cost ($/hr): <span class="slider-value" id="maxCost-value">10.0</span></label>
                    <input type="range" id="maxCost" min="0" max="20" value="10" step="0.1">
                </div>
            </div>

            <!-- Balance Parameters -->
            <div class="control-group">
                <h3>Balance Parameters</h3>
                <div class="slider-container">
                    <label>CPU StdDev (%): <span class="slider-value" id="cpuStdDev-value">15.0</span></label>
                    <input type="range" id="cpuStdDev" min="0" max="50" value="15" step="0.5">
                </div>
                <div class="slider-container">
                    <label>Memory StdDev (%): <span class="slider-value" id="memStdDev-value">20.0</span></label>
                    <input type="range" id="memStdDev" min="0" max="50" value="20" step="0.5">
                </div>
                <div class="slider-container">
                    <label>Weight - CPU: <span class="slider-value" id="wCPU-value">0.50</span></label>
                    <input type="range" id="wCPU" min="0" max="1" value="0.5" step="0.01">
                </div>
                <div class="slider-container">
                    <label>Weight - Memory: <span class="slider-value" id="wMem-value">0.50</span></label>
                    <input type="range" id="wMem" min="0" max="1" value="0.5" step="0.01">
                </div>
            </div>
        </div>

        <!-- Results Display -->
        <div class="results">
            <div class="result-box disruption">
                <div class="result-label">Disruption</div>
                <div class="result-value" id="disruption-result">0.000</div>
            </div>
            <div class="result-box cost">
                <div class="result-label">Cost</div>
                <div class="result-value" id="cost-result">0.000</div>
            </div>
            <div class="result-box balance">
                <div class="result-label">Balance</div>
                <div class="result-value" id="balance-result">0.000</div>
            </div>
        </div>
    </div>

    <!-- Visualization Plots -->
    <div class="container">
        <h2>Objective Function Visualizations</h2>
        <div id="disruption-plot" class="plot-container"></div>
        <div id="cost-plot" class="plot-container"></div>
        <div id="balance-plot" class="plot-container"></div>
    </div>

    <script>
        // Helper function to update slider value display
        function setupSlider(id) {
            const slider = document.getElementById(id);
            const valueSpan = document.getElementById(id + '-value');
            
            slider.addEventListener('input', function() {
                valueSpan.textContent = parseFloat(this.value).toFixed(this.step.includes('.') ? this.step.split('.')[1].length : 0);
                updateCalculations();
            });
        }

        // Setup all sliders
        const sliderIds = ['totalPods', 'podsMoved', 'avgColdStart', 'timeSlots', 'wMove', 'wCold', 'wTime',
                          'currentCost', 'minCost', 'maxCost', 'cpuStdDev', 'memStdDev', 'wCPU', 'wMem'];
        sliderIds.forEach(setupSlider);

        // Objective function calculations
        function calculateDisruption() {
            const totalPods = parseFloat(document.getElementById('totalPods').value);
            const podsMoved = parseFloat(document.getElementById('podsMoved').value);
            const avgColdStart = parseFloat(document.getElementById('avgColdStart').value);
            const timeSlots = parseFloat(document.getElementById('timeSlots').value);
            const wMove = parseFloat(document.getElementById('wMove').value);
            const wCold = parseFloat(document.getElementById('wCold').value);
            const wTime = parseFloat(document.getElementById('wTime').value);

            // Movement disruption (normalized by total pods)
            const movementDisruption = podsMoved / totalPods;

            // Cold start disruption (normalized with 1-minute baseline)
            const coldStartBaseline = 1.0; // 1 minute
            const coldStartDisruption = avgColdStart / coldStartBaseline;

            // Time slots disruption (arbitrary max of 10)
            const maxTimeSlots = 10;
            const timeSlotsDisruption = timeSlots / maxTimeSlots;

            // Combined weighted disruption
            const disruption = wMove * movementDisruption + 
                             wCold * coldStartDisruption + 
                             wTime * timeSlotsDisruption;

            return Math.min(1.0, disruption); // Cap at 1.0
        }

        function calculateCost() {
            const currentCost = parseFloat(document.getElementById('currentCost').value);
            const minCost = parseFloat(document.getElementById('minCost').value);
            const maxCost = parseFloat(document.getElementById('maxCost').value);

            if (maxCost <= minCost) return 0;
            
            // Deb's normalization
            return (currentCost - minCost) / (maxCost - minCost);
        }

        function calculateBalance() {
            const cpuStdDev = parseFloat(document.getElementById('cpuStdDev').value);
            const memStdDev = parseFloat(document.getElementById('memStdDev').value);
            const wCPU = parseFloat(document.getElementById('wCPU').value);
            const wMem = parseFloat(document.getElementById('wMem').value);

            // Normalize standard deviations (assuming max of 50%)
            const maxStdDev = 50.0;
            const cpuNorm = cpuStdDev / maxStdDev;
            const memNorm = memStdDev / maxStdDev;

            // Weighted combination
            return wCPU * cpuNorm + wMem * memNorm;
        }

        // Update all calculations and plots
        function updateCalculations() {
            // Calculate objective values
            const disruption = calculateDisruption();
            const cost = calculateCost();
            const balance = calculateBalance();

            // Update result displays
            document.getElementById('disruption-result').textContent = disruption.toFixed(3);
            document.getElementById('cost-result').textContent = cost.toFixed(3);
            document.getElementById('balance-result').textContent = balance.toFixed(3);

            // Update plots
            updatePlots();
        }

        // Create visualization plots
        function updatePlots() {
            const totalPods = parseFloat(document.getElementById('totalPods').value);
            const currentPodsMoved = parseFloat(document.getElementById('podsMoved').value);
            const currentCostValue = parseFloat(document.getElementById('currentCost').value);
            const currentCpuStdDev = parseFloat(document.getElementById('cpuStdDev').value);

            // Disruption plot - vary pods moved
            const podsMovedRange = Array.from({length: 101}, (_, i) => i);
            const disruptionValues = podsMovedRange.map(pods => {
                document.getElementById('podsMoved').value = pods;
                return calculateDisruption();
            });
            document.getElementById('podsMoved').value = currentPodsMoved;

            const disruptionTrace = {
                x: podsMovedRange,
                y: disruptionValues,
                type: 'scatter',
                mode: 'lines',
                name: 'Disruption',
                line: {color: 'red', width: 3}
            };

            const disruptionLayout = {
                title: 'Disruption vs Pods Moved',
                xaxis: {title: 'Pods Moved'},
                yaxis: {title: 'Disruption Score', range: [0, 1]},
                shapes: [{
                    type: 'line',
                    x0: currentPodsMoved, x1: currentPodsMoved,
                    y0: 0, y1: 1,
                    line: {color: 'black', width: 2, dash: 'dash'}
                }]
            };

            Plotly.newPlot('disruption-plot', [disruptionTrace], disruptionLayout);

            // Cost plot - vary current cost
            const costRange = Array.from({length: 201}, (_, i) => i * 0.1);
            const minCost = parseFloat(document.getElementById('minCost').value);
            const maxCost = parseFloat(document.getElementById('maxCost').value);
            
            const costValues = costRange.map(cost => {
                document.getElementById('currentCost').value = cost;
                return calculateCost();
            });
            document.getElementById('currentCost').value = currentCostValue;

            const costTrace = {
                x: costRange,
                y: costValues,
                type: 'scatter',
                mode: 'lines',
                name: 'Cost',
                line: {color: 'green', width: 3}
            };

            const costLayout = {
                title: 'Cost Normalization',
                xaxis: {title: 'Current Cost ($/hr)'},
                yaxis: {title: 'Normalized Cost', range: [-0.1, 1.1]},
                shapes: [
                    {
                        type: 'line',
                        x0: currentCostValue, x1: currentCostValue,
                        y0: -0.1, y1: 1.1,
                        line: {color: 'black', width: 2, dash: 'dash'}
                    },
                    {
                        type: 'line',
                        x0: minCost, x1: minCost,
                        y0: -0.1, y1: 1.1,
                        line: {color: 'blue', width: 1, dash: 'dot'}
                    },
                    {
                        type: 'line',
                        x0: maxCost, x1: maxCost,
                        y0: -0.1, y1: 1.1,
                        line: {color: 'red', width: 1, dash: 'dot'}
                    }
                ],
                annotations: [
                    {x: minCost, y: 1.05, text: 'Min', showarrow: false},
                    {x: maxCost, y: 1.05, text: 'Max', showarrow: false}
                ]
            };

            Plotly.newPlot('cost-plot', [costTrace], costLayout);

            // Balance plot - vary CPU StdDev
            const stdDevRange = Array.from({length: 51}, (_, i) => i);
            const balanceValues = stdDevRange.map(stdDev => {
                document.getElementById('cpuStdDev').value = stdDev;
                return calculateBalance();
            });
            document.getElementById('cpuStdDev').value = currentCpuStdDev;

            const balanceTrace = {
                x: stdDevRange,
                y: balanceValues,
                type: 'scatter',
                mode: 'lines',
                name: 'Balance',
                line: {color: 'orange', width: 3}
            };

            const balanceLayout = {
                title: 'Balance vs CPU Standard Deviation',
                xaxis: {title: 'CPU StdDev (%)'},
                yaxis: {title: 'Balance Score', range: [0, 1]},
                shapes: [{
                    type: 'line',
                    x0: currentCpuStdDev, x1: currentCpuStdDev,
                    y0: 0, y1: 1,
                    line: {color: 'black', width: 2, dash: 'dash'}
                }]
            };

            Plotly.newPlot('balance-plot', [balanceTrace], balanceLayout);
        }

        // Initial calculation
        updateCalculations();
    </script>
</body>
</html>
